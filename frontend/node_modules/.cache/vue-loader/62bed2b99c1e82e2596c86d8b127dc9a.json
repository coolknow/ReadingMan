{"remainingRequest":"/Users/huhaodong/Desktop/speakBook/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huhaodong/Desktop/speakBook/src/views/login/login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huhaodong/Desktop/speakBook/src/views/login/login.vue","mtime":1656836396304},{"path":"/Users/huhaodong/Desktop/speakBook/node_modules/cache-loader/dist/cjs.js","mtime":1656821619186},{"path":"/Users/huhaodong/Desktop/speakBook/node_modules/babel-loader/lib/index.js","mtime":1656821619389},{"path":"/Users/huhaodong/Desktop/speakBook/node_modules/cache-loader/dist/cjs.js","mtime":1656821619186},{"path":"/Users/huhaodong/Desktop/speakBook/node_modules/vue-loader/lib/index.js","mtime":1656821616996}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGxvZ2luLCByZWdpc3RlciB9IGZyb20gIkAvYXBpL3VzZXJzIjsKaW1wb3J0IGIxIGZyb20gIi4uLy4uL2Fzc2V0cy9iMS5qcGciOwppbXBvcnQgYjIgZnJvbSAiLi4vLi4vYXNzZXRzL2IyLmpwZyI7CmltcG9ydCBiMyBmcm9tICIuLi8uLi9hc3NldHMvYjMuanBnIjsKaW1wb3J0IGI0IGZyb20gIi4uLy4uL2Fzc2V0cy9iNC5qcGciOwppbXBvcnQgYjUgZnJvbSAiLi4vLi4vYXNzZXRzL2I1LmpwZyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkxvZ2luIiwKICBkYXRhKCkgewogICAgdmFyIHZhbGlkYXRlUGFzcyA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsKICAgICAgaWYgKHZhbHVlID09PSAiIikgewogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi6K+35YaN5qyh6L6T5YWl5a+G56CBIikpOwogICAgICB9IGVsc2UgaWYgKHZhbHVlICE9PSB0aGlzLmxvZ2luRm9ybS5wd2QpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIuS4pOasoei+k+WFpeWvhueggeS4jeS4gOiHtCEiKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQogICAgfTsKICAgIHJldHVybiB7CiAgICAgIGltZ0NvZGU6IGZhbHNlLAogICAgICBsb2dpbkZvcm06IHsKICAgICAgICB1c2VybmFtZTogIiIsCiAgICAgICAgcHdkOiAiIiwKICAgICAgICBtb3JlUHdkOiAiIiwKICAgICAgfSwKICAgICAgYmdJbWdzOiBbYjEsIGIyLCBiMywgYjQsIGI1XSwKICAgICAgbG9naW5SdWxlczogewogICAgICAgIHVzZXJuYW1lOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCB0cmlnZ2VyOiAiYmx1ciIsIG1lc3NhZ2U6ICLor7fovpPlhaXmgqjnmoTnlKjmiLflkI0iIH0sCiAgICAgICAgXSwKICAgICAgICBwd2Q6IFt7IHJlcXVpcmVkOiB0cnVlLCB0cmlnZ2VyOiAiYmx1ciIsIG1lc3NhZ2U6ICLor7fovpPlhaXmgqjnmoTlr4bnoIEiIH1dLAogICAgICAgIG1vcmVQd2Q6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIHRyaWdnZXI6ICJibHVyIiwgbWVzc2FnZTogIuivt+WGjeasoei+k+WFpeaCqOeahOWvhueggSIgfSwKICAgICAgICAgIHsgdmFsaWRhdG9yOiB2YWxpZGF0ZVBhc3MsIHRyaWdnZXI6ICJibHVyIiB9LAogICAgICAgIF0sCiAgICAgIH0sCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBwYXNzd29yZFR5cGU6ICJwYXNzd29yZCIsCiAgICAgIHJlZGlyZWN0OiB1bmRlZmluZWQsCiAgICAgIGlzTG9naW46IHRydWUsCiAgICB9OwogIH0sCiAgd2F0Y2g6IHsKICAgICRyb3V0ZTogewogICAgICBoYW5kbGVyOiBmdW5jdGlvbiAocm91dGUpIHsKICAgICAgICB0aGlzLnJlZGlyZWN0ID0gcm91dGUucXVlcnkgJiYgcm91dGUucXVlcnkucmVkaXJlY3Q7CiAgICAgIH0sCiAgICAgIGltbWVkaWF0ZTogdHJ1ZSwKICAgIH0sCiAgfSwKICBtZXRob2RzOiB7CiAgICBzZXRJc0xvZ2luKCkgewogICAgICB0aGlzLmlzTG9naW4gPSAhdGhpcy5pc0xvZ2luOwogICAgICB0aGlzLmltZ0NvZGUgPSBmYWxzZTsKICAgICAgdGhpcy4kcmVmcy5zbGlkZWJsb2NrLnJlc2V0KCk7CiAgICB9LAogICAgb25TdWNjZXNzKCkgewogICAgICB0aGlzLmltZ0NvZGUgPSB0cnVlOwogICAgfSwKICAgIG9uRmFpbCgpIHsKICAgICAgdGhpcy5pbWdDb2RlID0gZmFsc2U7CiAgICB9LAogICAgb25SZWZyZXNoKCkgewogICAgICB0aGlzLmltZ0NvZGUgPSBmYWxzZTsKICAgIH0sCiAgICBzaG93UHdkKCkgewogICAgICBpZiAodGhpcy5wYXNzd29yZFR5cGUgPT09ICJwYXNzd29yZCIpIHsKICAgICAgICB0aGlzLnBhc3N3b3JkVHlwZSA9ICIiOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucGFzc3dvcmRUeXBlID0gInBhc3N3b3JkIjsKICAgICAgfQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy4kcmVmcy5wYXNzd29yZC5mb2N1cygpOwogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVMb2dpbigpIHsKICAgICAgaWYgKCF0aGlzLmltZ0NvZGUpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLor7flrozmiJDmu5HlnZfpqozor4HvvIEiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy4kcmVmcy5sb2dpbkZvcm0udmFsaWRhdGUoKHZhbGlkKSA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBjb25zdCB7IHVzZXJuYW1lLCBwd2QgfSA9IHRoaXMubG9naW5Gb3JtOwogICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgIC8vIHRoaXMuJHJvdXRlci5wdXNoKCIvIik7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZygiY2hlY2twb2ludDEiKTsKICAgICAgICAgIC8vIHJldHVybjsKICAgICAgICAgIGNvbnNvbGUubG9nKCJjaGVja3BvaW50MiIpOwogICAgICAgICAgaWYgKHRoaXMuaXNMb2dpbikgewogICAgICAgICAgICAvLyDnmbvlvZXlpITnkIYKICAgICAgICAgICAgbG9naW4oewogICAgICAgICAgICAgIHVzZXJuYW1lLAogICAgICAgICAgICAgIHB3ZCwKICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgibG9naW4iLCByZXMuZGF0YSk7CiAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiLyIpOwogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8g5rOo5YaMCiAgICAgICAgICAgIHJlZ2lzdGVyKHsKICAgICAgICAgICAgICB1c2VybmFtZSwKICAgICAgICAgICAgICBwd2QsCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLnNldElzTG9naW4oKTsKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5rOo5YaM5oiQ5Yqf77yM6K+356uL5Y2z55m75b2V77yBIik7CiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAuY2F0Y2goKCkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJlcnJvciBzdWJtaXQhISIpOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"login.vue","sourceRoot":"src/views/login","sourcesContent":["<template>\n  <div class=\"login-container\">\n    <el-form\n      ref=\"loginForm\"\n      :model=\"loginForm\"\n      :rules=\"loginRules\"\n      class=\"login-form\"\n      auto-complete=\"on\"\n      label-position=\"left\"\n    >\n      <div class=\"title-container\">\n        <h3 class=\"title\">友趣读书</h3>\n      </div>\n\n      <el-form-item prop=\"username\">\n        <span class=\"svg-container\">\n          <svg-icon icon-class=\"user\" />\n        </span>\n        <el-input\n          ref=\"username\"\n          v-model=\"loginForm.username\"\n          placeholder=\"用户名\"\n          name=\"username\"\n          type=\"text\"\n          tabindex=\"1\"\n          auto-complete=\"on\"\n        />\n      </el-form-item>\n\n      <el-form-item prop=\"pwd\">\n        <span class=\"svg-container\">\n          <svg-icon icon-class=\"password\" />\n        </span>\n        <el-input\n          :key=\"passwordType\"\n          v-model=\"loginForm.pwd\"\n          :type=\"passwordType\"\n          placeholder=\"密码\"\n          name=\"pwd\"\n          tabindex=\"2\"\n          auto-complete=\"on\"\n          @keyup.enter.native=\"handleLogin\"\n        />\n        <span class=\"show-pwd\" @click=\"showPwd\">\n          <svg-icon\n            :icon-class=\"passwordType === 'password' ? 'eye' : 'eye-open'\"\n          />\n        </span>\n      </el-form-item>\n\n      <el-form-item v-if=\"!isLogin\" prop=\"morePwd\">\n        <span class=\"svg-container\">\n          <svg-icon icon-class=\"password\" />\n        </span>\n        <el-input\n          :key=\"passwordType\"\n          v-model=\"loginForm.morePwd\"\n          :type=\"passwordType\"\n          placeholder=\"再次输入密码\"\n          name=\"morePwd\"\n          tabindex=\"2\"\n          auto-complete=\"on\"\n        />\n        <span class=\"show-pwd\" @click=\"showPwd\">\n          <svg-icon\n            :icon-class=\"passwordType === 'password' ? 'eye' : 'eye-open'\"\n          />\n        </span>\n      </el-form-item>\n\n      <div class=\"codeBox\">\n        <slide-verify\n          :l=\"42\"\n          :r=\"10\"\n          :w=\"450\"\n          :h=\"100\"\n          :imgs=\"bgImgs\"\n          slider-text=\"向右滑动\"\n          @success=\"onSuccess\"\n          @fail=\"onFail\"\n          @refresh=\"onRefresh\"\n          ref=\"slideblock\"\n        ></slide-verify>\n      </div>\n\n      <el-button\n        :loading=\"loading\"\n        type=\"primary\"\n        style=\"width: 100%; margin-bottom: 30px\"\n        @click.native.prevent=\"handleLogin\"\n        >{{ !isLogin ? \"立即注册\" : \"立即登录\" }}</el-button\n      >\n      <div @click=\"setIsLogin\" class=\"tipBox\">\n        {{ isLogin ? \"还没账号？立即注册\" : \"已有账号，立即登录\" }}\n      </div>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { login, register } from \"@/api/users\";\nimport b1 from \"../../assets/b1.jpg\";\nimport b2 from \"../../assets/b2.jpg\";\nimport b3 from \"../../assets/b3.jpg\";\nimport b4 from \"../../assets/b4.jpg\";\nimport b5 from \"../../assets/b5.jpg\";\n\nexport default {\n  name: \"Login\",\n  data() {\n    var validatePass = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请再次输入密码\"));\n      } else if (value !== this.loginForm.pwd) {\n        callback(new Error(\"两次输入密码不一致!\"));\n      } else {\n        callback();\n      }\n    };\n    return {\n      imgCode: false,\n      loginForm: {\n        username: \"\",\n        pwd: \"\",\n        morePwd: \"\",\n      },\n      bgImgs: [b1, b2, b3, b4, b5],\n      loginRules: {\n        username: [\n          { required: true, trigger: \"blur\", message: \"请输入您的用户名\" },\n        ],\n        pwd: [{ required: true, trigger: \"blur\", message: \"请输入您的密码\" }],\n        morePwd: [\n          { required: true, trigger: \"blur\", message: \"请再次输入您的密码\" },\n          { validator: validatePass, trigger: \"blur\" },\n        ],\n      },\n      loading: false,\n      passwordType: \"password\",\n      redirect: undefined,\n      isLogin: true,\n    };\n  },\n  watch: {\n    $route: {\n      handler: function (route) {\n        this.redirect = route.query && route.query.redirect;\n      },\n      immediate: true,\n    },\n  },\n  methods: {\n    setIsLogin() {\n      this.isLogin = !this.isLogin;\n      this.imgCode = false;\n      this.$refs.slideblock.reset();\n    },\n    onSuccess() {\n      this.imgCode = true;\n    },\n    onFail() {\n      this.imgCode = false;\n    },\n    onRefresh() {\n      this.imgCode = false;\n    },\n    showPwd() {\n      if (this.passwordType === \"password\") {\n        this.passwordType = \"\";\n      } else {\n        this.passwordType = \"password\";\n      }\n      this.$nextTick(() => {\n        this.$refs.password.focus();\n      });\n    },\n    handleLogin() {\n      if (!this.imgCode) {\n        this.$message.error(\"请完成滑块验证！\");\n        return;\n      }\n      this.$refs.loginForm.validate((valid) => {\n        if (valid) {\n          const { username, pwd } = this.loginForm;\n          this.loading = true;\n          // this.$router.push(\"/\");\n          // console.log(\"checkpoint1\");\n          // return;\n          console.log(\"checkpoint2\");\n          if (this.isLogin) {\n            // 登录处理\n            login({\n              username,\n              pwd,\n            })\n              .then((res) => {\n                this.loading = false;\n                this.$store.commit(\"login\", res.data);\n                this.$router.push(\"/\");\n              })\n              .catch(() => {\n                this.loading = false;\n              });\n          } else {\n            // 注册\n            register({\n              username,\n              pwd,\n            })\n              .then((res) => {\n                this.loading = false;\n                this.setIsLogin();\n                this.$message.success(\"注册成功，请立即登录！\");\n              })\n              .catch(() => {\n                this.loading = false;\n              });\n          }\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n@import \"./login.scss\";\n</style>\n"]}]}