{"remainingRequest":"/Users/huhaodong/Desktop/speakBook/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huhaodong/Desktop/speakBook/src/views/login/login.vue?vue&type=style&index=0&id=a49090ce&lang=scss&","dependencies":[{"path":"/Users/huhaodong/Desktop/speakBook/src/views/login/login.vue","mtime":1656836396304},{"path":"/Users/huhaodong/Desktop/speakBook/node_modules/css-loader/dist/cjs.js","mtime":1656821616934},{"path":"/Users/huhaodong/Desktop/speakBook/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1656821616997},{"path":"/Users/huhaodong/Desktop/speakBook/node_modules/postcss-loader/src/index.js","mtime":1656821616659},{"path":"/Users/huhaodong/Desktop/speakBook/node_modules/sass-loader/dist/cjs.js","mtime":1656821619560},{"path":"/Users/huhaodong/Desktop/speakBook/node_modules/cache-loader/dist/cjs.js","mtime":1656821619186},{"path":"/Users/huhaodong/Desktop/speakBook/node_modules/vue-loader/lib/index.js","mtime":1656821616996}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCkBpbXBvcnQgIi4vbG9naW4uc2NzcyI7Cg=="},{"version":3,"sources":["login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqOA","file":"login.vue","sourceRoot":"src/views/login","sourcesContent":["<template>\n  <div class=\"login-container\">\n    <el-form\n      ref=\"loginForm\"\n      :model=\"loginForm\"\n      :rules=\"loginRules\"\n      class=\"login-form\"\n      auto-complete=\"on\"\n      label-position=\"left\"\n    >\n      <div class=\"title-container\">\n        <h3 class=\"title\">友趣读书</h3>\n      </div>\n\n      <el-form-item prop=\"username\">\n        <span class=\"svg-container\">\n          <svg-icon icon-class=\"user\" />\n        </span>\n        <el-input\n          ref=\"username\"\n          v-model=\"loginForm.username\"\n          placeholder=\"用户名\"\n          name=\"username\"\n          type=\"text\"\n          tabindex=\"1\"\n          auto-complete=\"on\"\n        />\n      </el-form-item>\n\n      <el-form-item prop=\"pwd\">\n        <span class=\"svg-container\">\n          <svg-icon icon-class=\"password\" />\n        </span>\n        <el-input\n          :key=\"passwordType\"\n          v-model=\"loginForm.pwd\"\n          :type=\"passwordType\"\n          placeholder=\"密码\"\n          name=\"pwd\"\n          tabindex=\"2\"\n          auto-complete=\"on\"\n          @keyup.enter.native=\"handleLogin\"\n        />\n        <span class=\"show-pwd\" @click=\"showPwd\">\n          <svg-icon\n            :icon-class=\"passwordType === 'password' ? 'eye' : 'eye-open'\"\n          />\n        </span>\n      </el-form-item>\n\n      <el-form-item v-if=\"!isLogin\" prop=\"morePwd\">\n        <span class=\"svg-container\">\n          <svg-icon icon-class=\"password\" />\n        </span>\n        <el-input\n          :key=\"passwordType\"\n          v-model=\"loginForm.morePwd\"\n          :type=\"passwordType\"\n          placeholder=\"再次输入密码\"\n          name=\"morePwd\"\n          tabindex=\"2\"\n          auto-complete=\"on\"\n        />\n        <span class=\"show-pwd\" @click=\"showPwd\">\n          <svg-icon\n            :icon-class=\"passwordType === 'password' ? 'eye' : 'eye-open'\"\n          />\n        </span>\n      </el-form-item>\n\n      <div class=\"codeBox\">\n        <slide-verify\n          :l=\"42\"\n          :r=\"10\"\n          :w=\"450\"\n          :h=\"100\"\n          :imgs=\"bgImgs\"\n          slider-text=\"向右滑动\"\n          @success=\"onSuccess\"\n          @fail=\"onFail\"\n          @refresh=\"onRefresh\"\n          ref=\"slideblock\"\n        ></slide-verify>\n      </div>\n\n      <el-button\n        :loading=\"loading\"\n        type=\"primary\"\n        style=\"width: 100%; margin-bottom: 30px\"\n        @click.native.prevent=\"handleLogin\"\n        >{{ !isLogin ? \"立即注册\" : \"立即登录\" }}</el-button\n      >\n      <div @click=\"setIsLogin\" class=\"tipBox\">\n        {{ isLogin ? \"还没账号？立即注册\" : \"已有账号，立即登录\" }}\n      </div>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { login, register } from \"@/api/users\";\nimport b1 from \"../../assets/b1.jpg\";\nimport b2 from \"../../assets/b2.jpg\";\nimport b3 from \"../../assets/b3.jpg\";\nimport b4 from \"../../assets/b4.jpg\";\nimport b5 from \"../../assets/b5.jpg\";\n\nexport default {\n  name: \"Login\",\n  data() {\n    var validatePass = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请再次输入密码\"));\n      } else if (value !== this.loginForm.pwd) {\n        callback(new Error(\"两次输入密码不一致!\"));\n      } else {\n        callback();\n      }\n    };\n    return {\n      imgCode: false,\n      loginForm: {\n        username: \"\",\n        pwd: \"\",\n        morePwd: \"\",\n      },\n      bgImgs: [b1, b2, b3, b4, b5],\n      loginRules: {\n        username: [\n          { required: true, trigger: \"blur\", message: \"请输入您的用户名\" },\n        ],\n        pwd: [{ required: true, trigger: \"blur\", message: \"请输入您的密码\" }],\n        morePwd: [\n          { required: true, trigger: \"blur\", message: \"请再次输入您的密码\" },\n          { validator: validatePass, trigger: \"blur\" },\n        ],\n      },\n      loading: false,\n      passwordType: \"password\",\n      redirect: undefined,\n      isLogin: true,\n    };\n  },\n  watch: {\n    $route: {\n      handler: function (route) {\n        this.redirect = route.query && route.query.redirect;\n      },\n      immediate: true,\n    },\n  },\n  methods: {\n    setIsLogin() {\n      this.isLogin = !this.isLogin;\n      this.imgCode = false;\n      this.$refs.slideblock.reset();\n    },\n    onSuccess() {\n      this.imgCode = true;\n    },\n    onFail() {\n      this.imgCode = false;\n    },\n    onRefresh() {\n      this.imgCode = false;\n    },\n    showPwd() {\n      if (this.passwordType === \"password\") {\n        this.passwordType = \"\";\n      } else {\n        this.passwordType = \"password\";\n      }\n      this.$nextTick(() => {\n        this.$refs.password.focus();\n      });\n    },\n    handleLogin() {\n      if (!this.imgCode) {\n        this.$message.error(\"请完成滑块验证！\");\n        return;\n      }\n      this.$refs.loginForm.validate((valid) => {\n        if (valid) {\n          const { username, pwd } = this.loginForm;\n          this.loading = true;\n          // this.$router.push(\"/\");\n          // console.log(\"checkpoint1\");\n          // return;\n          console.log(\"checkpoint2\");\n          if (this.isLogin) {\n            // 登录处理\n            login({\n              username,\n              pwd,\n            })\n              .then((res) => {\n                this.loading = false;\n                this.$store.commit(\"login\", res.data);\n                this.$router.push(\"/\");\n              })\n              .catch(() => {\n                this.loading = false;\n              });\n          } else {\n            // 注册\n            register({\n              username,\n              pwd,\n            })\n              .then((res) => {\n                this.loading = false;\n                this.setIsLogin();\n                this.$message.success(\"注册成功，请立即登录！\");\n              })\n              .catch(() => {\n                this.loading = false;\n              });\n          }\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n@import \"./login.scss\";\n</style>\n"]}]}