{"remainingRequest":"/Users/huhaodong/Desktop/speakBook/node_modules/babel-loader/lib/index.js!/Users/huhaodong/Desktop/speakBook/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/huhaodong/Desktop/speakBook/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huhaodong/Desktop/speakBook/src/views/login/login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huhaodong/Desktop/speakBook/src/views/login/login.vue","mtime":1656836396304},{"path":"/Users/huhaodong/Desktop/speakBook/babel.config.js","mtime":1637306514000},{"path":"/Users/huhaodong/Desktop/speakBook/node_modules/cache-loader/dist/cjs.js","mtime":1656821619186},{"path":"/Users/huhaodong/Desktop/speakBook/node_modules/babel-loader/lib/index.js","mtime":1656821619389},{"path":"/Users/huhaodong/Desktop/speakBook/node_modules/cache-loader/dist/cjs.js","mtime":1656821619186},{"path":"/Users/huhaodong/Desktop/speakBook/node_modules/vue-loader/lib/index.js","mtime":1656821616996}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyBsb2dpbiwgcmVnaXN0ZXIgfSBmcm9tICJAL2FwaS91c2VycyI7CmltcG9ydCBiMSBmcm9tICIuLi8uLi9hc3NldHMvYjEuanBnIjsKaW1wb3J0IGIyIGZyb20gIi4uLy4uL2Fzc2V0cy9iMi5qcGciOwppbXBvcnQgYjMgZnJvbSAiLi4vLi4vYXNzZXRzL2IzLmpwZyI7CmltcG9ydCBiNCBmcm9tICIuLi8uLi9hc3NldHMvYjQuanBnIjsKaW1wb3J0IGI1IGZyb20gIi4uLy4uL2Fzc2V0cy9iNS5qcGciOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkxvZ2luIiwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB2YXIgdmFsaWRhdGVQYXNzID0gZnVuY3Rpb24gdmFsaWRhdGVQYXNzKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgewogICAgICBpZiAodmFsdWUgPT09ICIiKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCLor7flho3mrKHovpPlhaXlr4bnoIEiKSk7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgIT09IF90aGlzLmxvZ2luRm9ybS5wd2QpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIuS4pOasoei+k+WFpeWvhueggeS4jeS4gOiHtCEiKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gewogICAgICBpbWdDb2RlOiBmYWxzZSwKICAgICAgbG9naW5Gb3JtOiB7CiAgICAgICAgdXNlcm5hbWU6ICIiLAogICAgICAgIHB3ZDogIiIsCiAgICAgICAgbW9yZVB3ZDogIiIKICAgICAgfSwKICAgICAgYmdJbWdzOiBbYjEsIGIyLCBiMywgYjQsIGI1XSwKICAgICAgbG9naW5SdWxlczogewogICAgICAgIHVzZXJuYW1lOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIsCiAgICAgICAgICBtZXNzYWdlOiAi6K+36L6T5YWl5oKo55qE55So5oi35ZCNIgogICAgICAgIH1dLAogICAgICAgIHB3ZDogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgdHJpZ2dlcjogImJsdXIiLAogICAgICAgICAgbWVzc2FnZTogIuivt+i+k+WFpeaCqOeahOWvhueggSIKICAgICAgICB9XSwKICAgICAgICBtb3JlUHdkOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIsCiAgICAgICAgICBtZXNzYWdlOiAi6K+35YaN5qyh6L6T5YWl5oKo55qE5a+G56CBIgogICAgICAgIH0sIHsKICAgICAgICAgIHZhbGlkYXRvcjogdmFsaWRhdGVQYXNzLAogICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgfV0KICAgICAgfSwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIHBhc3N3b3JkVHlwZTogInBhc3N3b3JkIiwKICAgICAgcmVkaXJlY3Q6IHVuZGVmaW5lZCwKICAgICAgaXNMb2dpbjogdHJ1ZQogICAgfTsKICB9LAogIHdhdGNoOiB7CiAgICAkcm91dGU6IHsKICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcihyb3V0ZSkgewogICAgICAgIHRoaXMucmVkaXJlY3QgPSByb3V0ZS5xdWVyeSAmJiByb3V0ZS5xdWVyeS5yZWRpcmVjdDsKICAgICAgfSwKICAgICAgaW1tZWRpYXRlOiB0cnVlCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBzZXRJc0xvZ2luOiBmdW5jdGlvbiBzZXRJc0xvZ2luKCkgewogICAgICB0aGlzLmlzTG9naW4gPSAhdGhpcy5pc0xvZ2luOwogICAgICB0aGlzLmltZ0NvZGUgPSBmYWxzZTsKICAgICAgdGhpcy4kcmVmcy5zbGlkZWJsb2NrLnJlc2V0KCk7CiAgICB9LAogICAgb25TdWNjZXNzOiBmdW5jdGlvbiBvblN1Y2Nlc3MoKSB7CiAgICAgIHRoaXMuaW1nQ29kZSA9IHRydWU7CiAgICB9LAogICAgb25GYWlsOiBmdW5jdGlvbiBvbkZhaWwoKSB7CiAgICAgIHRoaXMuaW1nQ29kZSA9IGZhbHNlOwogICAgfSwKICAgIG9uUmVmcmVzaDogZnVuY3Rpb24gb25SZWZyZXNoKCkgewogICAgICB0aGlzLmltZ0NvZGUgPSBmYWxzZTsKICAgIH0sCiAgICBzaG93UHdkOiBmdW5jdGlvbiBzaG93UHdkKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGlmICh0aGlzLnBhc3N3b3JkVHlwZSA9PT0gInBhc3N3b3JkIikgewogICAgICAgIHRoaXMucGFzc3dvcmRUeXBlID0gIiI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5wYXNzd29yZFR5cGUgPSAicGFzc3dvcmQiOwogICAgICB9CgogICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMyLiRyZWZzLnBhc3N3b3JkLmZvY3VzKCk7CiAgICAgIH0pOwogICAgfSwKICAgIGhhbmRsZUxvZ2luOiBmdW5jdGlvbiBoYW5kbGVMb2dpbigpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMuaW1nQ29kZSkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuivt+WujOaIkOa7keWdl+mqjOivge+8gSIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy4kcmVmcy5sb2dpbkZvcm0udmFsaWRhdGUoZnVuY3Rpb24gKHZhbGlkKSB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICB2YXIgX3RoaXMzJGxvZ2luRm9ybSA9IF90aGlzMy5sb2dpbkZvcm0sCiAgICAgICAgICAgICAgdXNlcm5hbWUgPSBfdGhpczMkbG9naW5Gb3JtLnVzZXJuYW1lLAogICAgICAgICAgICAgIHB3ZCA9IF90aGlzMyRsb2dpbkZvcm0ucHdkOwogICAgICAgICAgX3RoaXMzLmxvYWRpbmcgPSB0cnVlOyAvLyB0aGlzLiRyb3V0ZXIucHVzaCgiLyIpOwogICAgICAgICAgLy8gY29uc29sZS5sb2coImNoZWNrcG9pbnQxIik7CiAgICAgICAgICAvLyByZXR1cm47CgogICAgICAgICAgY29uc29sZS5sb2coImNoZWNrcG9pbnQyIik7CgogICAgICAgICAgaWYgKF90aGlzMy5pc0xvZ2luKSB7CiAgICAgICAgICAgIC8vIOeZu+W9leWkhOeQhgogICAgICAgICAgICBsb2dpbih7CiAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLAogICAgICAgICAgICAgIHB3ZDogcHdkCiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgIF90aGlzMy5sb2FkaW5nID0gZmFsc2U7CgogICAgICAgICAgICAgIF90aGlzMy4kc3RvcmUuY29tbWl0KCJsb2dpbiIsIHJlcy5kYXRhKTsKCiAgICAgICAgICAgICAgX3RoaXMzLiRyb3V0ZXIucHVzaCgiLyIpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgX3RoaXMzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyDms6jlhowKICAgICAgICAgICAgcmVnaXN0ZXIoewogICAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSwKICAgICAgICAgICAgICBwd2Q6IHB3ZAogICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICBfdGhpczMubG9hZGluZyA9IGZhbHNlOwoKICAgICAgICAgICAgICBfdGhpczMuc2V0SXNMb2dpbigpOwoKICAgICAgICAgICAgICBfdGhpczMuJG1lc3NhZ2Uuc3VjY2Vzcygi5rOo5YaM5oiQ5Yqf77yM6K+356uL5Y2z55m75b2V77yBIik7CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBfdGhpczMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coImVycm9yIHN1Ym1pdCEhIik7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoGA;AACA;AACA;AACA;AACA;AACA;AAEA;EACAA,aADA;EAEAC,IAFA,kBAEA;IAAA;;IACA;MACA;QACAC;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA;IACA,CARA;;IASA;MACAC,cADA;MAEAC;QACAC,YADA;QAEAC,OAFA;QAGAC;MAHA,CAFA;MAOAC,4BAPA;MAQAC;QACAJ,WACA;UAAAK;UAAAC;UAAAC;QAAA,CADA,CADA;QAIAN;UAAAI;UAAAC;UAAAC;QAAA,EAJA;QAKAL,UACA;UAAAG;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAC;UAAAF;QAAA,CAFA;MALA,CARA;MAkBAG,cAlBA;MAmBAC,wBAnBA;MAoBAC,mBApBA;MAqBAC;IArBA;EAuBA,CAnCA;EAoCAC;IACAC;MACAC;QACA;MACA,CAHA;MAIAC;IAJA;EADA,CApCA;EA4CAC;IACAC,UADA,wBACA;MACA;MACA;MACA;IACA,CALA;IAMAC,SANA,uBAMA;MACA;IACA,CARA;IASAC,MATA,oBASA;MACA;IACA,CAXA;IAYAC,SAZA,uBAYA;MACA;IACA,CAdA;IAeAC,OAfA,qBAeA;MAAA;;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA;;MACA;QACA;MACA,CAFA;IAGA,CAxBA;IAyBAC,WAzBA,yBAyBA;MAAA;;MACA;QACA;QACA;MACA;;MACA;QACA;UACA;UAAA;UAAA;UACA,sBAFA,CAGA;UACA;UACA;;UACAC;;UACA;YACA;YACAC;cACAzB,kBADA;cAEAC;YAFA,GAIAyB,IAJA,CAIA;cACA;;cACA;;cACA;YACA,CARA,EASAC,KATA,CASA;cACA;YACA,CAXA;UAYA,CAdA,MAcA;YACA;YACAC;cACA5B,kBADA;cAEAC;YAFA,GAIAyB,IAJA,CAIA;cACA;;cACA;;cACA;YACA,CARA,EASAC,KATA,CASA;cACA;YACA,CAXA;UAYA;QACA,CApCA,MAoCA;UACAH;UACA;QACA;MACA,CAzCA;IA0CA;EAxEA;AA5CA","names":["name","data","callback","imgCode","loginForm","username","pwd","morePwd","bgImgs","loginRules","required","trigger","message","validator","loading","passwordType","redirect","isLogin","watch","$route","handler","immediate","methods","setIsLogin","onSuccess","onFail","onRefresh","showPwd","handleLogin","console","login","then","catch","register"],"sourceRoot":"src/views/login","sources":["login.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <el-form\n      ref=\"loginForm\"\n      :model=\"loginForm\"\n      :rules=\"loginRules\"\n      class=\"login-form\"\n      auto-complete=\"on\"\n      label-position=\"left\"\n    >\n      <div class=\"title-container\">\n        <h3 class=\"title\">友趣读书</h3>\n      </div>\n\n      <el-form-item prop=\"username\">\n        <span class=\"svg-container\">\n          <svg-icon icon-class=\"user\" />\n        </span>\n        <el-input\n          ref=\"username\"\n          v-model=\"loginForm.username\"\n          placeholder=\"用户名\"\n          name=\"username\"\n          type=\"text\"\n          tabindex=\"1\"\n          auto-complete=\"on\"\n        />\n      </el-form-item>\n\n      <el-form-item prop=\"pwd\">\n        <span class=\"svg-container\">\n          <svg-icon icon-class=\"password\" />\n        </span>\n        <el-input\n          :key=\"passwordType\"\n          v-model=\"loginForm.pwd\"\n          :type=\"passwordType\"\n          placeholder=\"密码\"\n          name=\"pwd\"\n          tabindex=\"2\"\n          auto-complete=\"on\"\n          @keyup.enter.native=\"handleLogin\"\n        />\n        <span class=\"show-pwd\" @click=\"showPwd\">\n          <svg-icon\n            :icon-class=\"passwordType === 'password' ? 'eye' : 'eye-open'\"\n          />\n        </span>\n      </el-form-item>\n\n      <el-form-item v-if=\"!isLogin\" prop=\"morePwd\">\n        <span class=\"svg-container\">\n          <svg-icon icon-class=\"password\" />\n        </span>\n        <el-input\n          :key=\"passwordType\"\n          v-model=\"loginForm.morePwd\"\n          :type=\"passwordType\"\n          placeholder=\"再次输入密码\"\n          name=\"morePwd\"\n          tabindex=\"2\"\n          auto-complete=\"on\"\n        />\n        <span class=\"show-pwd\" @click=\"showPwd\">\n          <svg-icon\n            :icon-class=\"passwordType === 'password' ? 'eye' : 'eye-open'\"\n          />\n        </span>\n      </el-form-item>\n\n      <div class=\"codeBox\">\n        <slide-verify\n          :l=\"42\"\n          :r=\"10\"\n          :w=\"450\"\n          :h=\"100\"\n          :imgs=\"bgImgs\"\n          slider-text=\"向右滑动\"\n          @success=\"onSuccess\"\n          @fail=\"onFail\"\n          @refresh=\"onRefresh\"\n          ref=\"slideblock\"\n        ></slide-verify>\n      </div>\n\n      <el-button\n        :loading=\"loading\"\n        type=\"primary\"\n        style=\"width: 100%; margin-bottom: 30px\"\n        @click.native.prevent=\"handleLogin\"\n        >{{ !isLogin ? \"立即注册\" : \"立即登录\" }}</el-button\n      >\n      <div @click=\"setIsLogin\" class=\"tipBox\">\n        {{ isLogin ? \"还没账号？立即注册\" : \"已有账号，立即登录\" }}\n      </div>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { login, register } from \"@/api/users\";\nimport b1 from \"../../assets/b1.jpg\";\nimport b2 from \"../../assets/b2.jpg\";\nimport b3 from \"../../assets/b3.jpg\";\nimport b4 from \"../../assets/b4.jpg\";\nimport b5 from \"../../assets/b5.jpg\";\n\nexport default {\n  name: \"Login\",\n  data() {\n    var validatePass = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请再次输入密码\"));\n      } else if (value !== this.loginForm.pwd) {\n        callback(new Error(\"两次输入密码不一致!\"));\n      } else {\n        callback();\n      }\n    };\n    return {\n      imgCode: false,\n      loginForm: {\n        username: \"\",\n        pwd: \"\",\n        morePwd: \"\",\n      },\n      bgImgs: [b1, b2, b3, b4, b5],\n      loginRules: {\n        username: [\n          { required: true, trigger: \"blur\", message: \"请输入您的用户名\" },\n        ],\n        pwd: [{ required: true, trigger: \"blur\", message: \"请输入您的密码\" }],\n        morePwd: [\n          { required: true, trigger: \"blur\", message: \"请再次输入您的密码\" },\n          { validator: validatePass, trigger: \"blur\" },\n        ],\n      },\n      loading: false,\n      passwordType: \"password\",\n      redirect: undefined,\n      isLogin: true,\n    };\n  },\n  watch: {\n    $route: {\n      handler: function (route) {\n        this.redirect = route.query && route.query.redirect;\n      },\n      immediate: true,\n    },\n  },\n  methods: {\n    setIsLogin() {\n      this.isLogin = !this.isLogin;\n      this.imgCode = false;\n      this.$refs.slideblock.reset();\n    },\n    onSuccess() {\n      this.imgCode = true;\n    },\n    onFail() {\n      this.imgCode = false;\n    },\n    onRefresh() {\n      this.imgCode = false;\n    },\n    showPwd() {\n      if (this.passwordType === \"password\") {\n        this.passwordType = \"\";\n      } else {\n        this.passwordType = \"password\";\n      }\n      this.$nextTick(() => {\n        this.$refs.password.focus();\n      });\n    },\n    handleLogin() {\n      if (!this.imgCode) {\n        this.$message.error(\"请完成滑块验证！\");\n        return;\n      }\n      this.$refs.loginForm.validate((valid) => {\n        if (valid) {\n          const { username, pwd } = this.loginForm;\n          this.loading = true;\n          // this.$router.push(\"/\");\n          // console.log(\"checkpoint1\");\n          // return;\n          console.log(\"checkpoint2\");\n          if (this.isLogin) {\n            // 登录处理\n            login({\n              username,\n              pwd,\n            })\n              .then((res) => {\n                this.loading = false;\n                this.$store.commit(\"login\", res.data);\n                this.$router.push(\"/\");\n              })\n              .catch(() => {\n                this.loading = false;\n              });\n          } else {\n            // 注册\n            register({\n              username,\n              pwd,\n            })\n              .then((res) => {\n                this.loading = false;\n                this.setIsLogin();\n                this.$message.success(\"注册成功，请立即登录！\");\n              })\n              .catch(() => {\n                this.loading = false;\n              });\n          }\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n@import \"./login.scss\";\n</style>\n"]}]}